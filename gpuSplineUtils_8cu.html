<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: splines/gpuSplineUtils.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.1.4</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a3857b76c57a33866f3a59ae3b67734b.html">splines</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gpuSplineUtils.cu File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="gpuSplineUtils_8cuh_source.html">splines/gpuSplineUtils.cuh</a>&quot;</code><br />
</div>
<p><a href="gpuSplineUtils_8cu_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a466f32a4912da866d5014fd8cdbd06a4" id="r_a466f32a4912da866d5014fd8cdbd06a4"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>&#160;&#160;&#160;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a></td></tr>
<tr class="separator:a466f32a4912da866d5014fd8cdbd06a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a114ab798373602259d32aaabd590646a" id="r_a114ab798373602259d32aaabd590646a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a114ab798373602259d32aaabd590646a">InitGPU_SplineMonolith</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_weights_tf1, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_paramNo_TF1_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nParamPerEvent_tf1, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>)</td></tr>
<tr class="memdesc:a114ab798373602259d32aaabd590646a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory on gpu for spline monolith.  <br /></td></tr>
<tr class="separator:a114ab798373602259d32aaabd590646a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619be845847738447535c5628ff72c4c" id="r_a619be845847738447535c5628ff72c4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a619be845847738447535c5628ff72c4c">InitGPU_Segments</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>)</td></tr>
<tr class="memdesc:a619be845847738447535c5628ff72c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for spline segments.  <br /></td></tr>
<tr class="separator:a619be845847738447535c5628ff72c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3b24da038d746b5ccfcee61ba26b90" id="r_acc3b24da038d746b5ccfcee61ba26b90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#acc3b24da038d746b5ccfcee61ba26b90">InitGPU_Vals</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **vals)</td></tr>
<tr class="memdesc:acc3b24da038d746b5ccfcee61ba26b90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for spline segments.  <br /></td></tr>
<tr class="separator:acc3b24da038d746b5ccfcee61ba26b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace26806c324dbdc431f36f7b938a9b07" id="r_ace26806c324dbdc431f36f7b938a9b07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ace26806c324dbdc431f36f7b938a9b07">CopyToGPU_SplineMonolith</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_paramNo_arr</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_nKnots_arr</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_x_array</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_TF1</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array_TF1</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_paramNo_arr_TF1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; cpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nParamPerEvent, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_nParamPerEvent_TF1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_nParamPerEvent_TF1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>)</td></tr>
<tr class="memdesc:ace26806c324dbdc431f36f7b938a9b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy to GPU for x array and separate ybcd array.  <br /></td></tr>
<tr class="separator:ace26806c324dbdc431f36f7b938a9b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2f7c752f784e5e0dfc4b06c25608f9" id="r_a6a2f7c752f784e5e0dfc4b06c25608f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a6a2f7c752f784e5e0dfc4b06c25608f9">EvalOnGPU_Splines</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_coeff_many, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>)</td></tr>
<tr class="memdesc:a6a2f7c752f784e5e0dfc4b06c25608f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the spline on the GPU Using one {y,b,c,d} array and one {x} array Should be most efficient at cache hitting and memory coalescence But using spline segments rather than the parameter value: avoids doing binary search on GPU.  <br /></td></tr>
<tr class="separator:a6a2f7c752f784e5e0dfc4b06c25608f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae90fdf441edbf7a4d3520c3121f6e7a9" id="r_ae90fdf441edbf7a4d3520c3121f6e7a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae90fdf441edbf7a4d3520c3121f6e7a9">EvalOnGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs_tf1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_tf1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights_tf1)</td></tr>
<tr class="memdesc:ae90fdf441edbf7a4d3520c3121f6e7a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the TF1 on the GPU Using 5th order polynomial.  <br /></td></tr>
<tr class="separator:ae90fdf441edbf7a4d3520c3121f6e7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af53253fb379e8c3eaba886add0ba04" id="r_a1af53253fb379e8c3eaba886add0ba04"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a1af53253fb379e8c3eaba886add0ba04">EvalOnGPU_TotWeight</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_weights_tf1, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a>)</td></tr>
<tr class="memdesc:a1af53253fb379e8c3eaba886add0ba04"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Evaluate the total spline event weight on the GPU, as in most cases GPU is faster, even more this significant reduce memory transfer from GPU to CPU.  <br /></td></tr>
<tr class="separator:a1af53253fb379e8c3eaba886add0ba04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df46d32133c7ac37dbe2f2dae8b91b5" id="r_a4df46d32133c7ac37dbe2f2dae8b91b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a4df46d32133c7ac37dbe2f2dae8b91b5">RunGPU_SplineMonolith</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_coeff_many, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_tf1_arr</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeff_many_tf1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights_tf1, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *vals, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_tf1</a>)</td></tr>
<tr class="memdesc:a4df46d32133c7ac37dbe2f2dae8b91b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the GPU code for the separate many arrays. As in separate {x}, {y,b,c,d} arrays Pass the segment and the parameter values (binary search already performed in SplineMonolith::FindSplineSegment()  <br /></td></tr>
<tr class="separator:a4df46d32133c7ac37dbe2f2dae8b91b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953e5c5aecebd908f5d8c6ad64de482c" id="r_a953e5c5aecebd908f5d8c6ad64de482c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a953e5c5aecebd908f5d8c6ad64de482c">SynchroniseSplines</a> ()</td></tr>
<tr class="memdesc:a953e5c5aecebd908f5d8c6ad64de482c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure all Cuda threads finished execution.  <br /></td></tr>
<tr class="separator:a953e5c5aecebd908f5d8c6ad64de482c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac0e4ea2af61db5278d4a8f8cd6bd5d" id="r_a1ac0e4ea2af61db5278d4a8f8cd6bd5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a1ac0e4ea2af61db5278d4a8f8cd6bd5d">CleanupGPU_SplineMonolith</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_TF1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_nParamPerEvent_TF1</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights_tf1)</td></tr>
<tr class="memdesc:a1ac0e4ea2af61db5278d4a8f8cd6bd5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the {x},{ybcd} arrays.  <br /></td></tr>
<tr class="separator:a1ac0e4ea2af61db5278d4a8f8cd6bd5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17e68e55fea24bcac1dde0ef11fe299" id="r_ae17e68e55fea24bcac1dde0ef11fe299"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae17e68e55fea24bcac1dde0ef11fe299">CleanupGPU_Segments</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *vals)</td></tr>
<tr class="memdesc:ae17e68e55fea24bcac1dde0ef11fe299"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up pinned variables at CPU.  <br /></td></tr>
<tr class="separator:ae17e68e55fea24bcac1dde0ef11fe299"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8df652f27dcffc6b349298601ed790ea" id="r_a8df652f27dcffc6b349298601ed790ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a></td></tr>
<tr class="memdesc:a8df652f27dcffc6b349298601ed790ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of splines living on GPU.  <br /></td></tr>
<tr class="separator:a8df652f27dcffc6b349298601ed790ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d02be4848ebb3c6778c1c1250a5288" id="r_a70d02be4848ebb3c6778c1c1250a5288"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a70d02be4848ebb3c6778c1c1250a5288">d_n_TF1</a></td></tr>
<tr class="memdesc:a70d02be4848ebb3c6778c1c1250a5288"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of tf1 living on GPU.  <br /></td></tr>
<tr class="separator:a70d02be4848ebb3c6778c1c1250a5288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11082fcc44d3cf2e38cb74043fd7835" id="r_ae11082fcc44d3cf2e38cb74043fd7835"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a></td></tr>
<tr class="memdesc:ae11082fcc44d3cf2e38cb74043fd7835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of splines living on GPU.  <br /></td></tr>
<tr class="separator:ae11082fcc44d3cf2e38cb74043fd7835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad333bfa4035ada9207fc1df19272c4e2" id="r_ad333bfa4035ada9207fc1df19272c4e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a></td></tr>
<tr class="memdesc:ad333bfa4035ada9207fc1df19272c4e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of events living on GPU.  <br /></td></tr>
<tr class="separator:ad333bfa4035ada9207fc1df19272c4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac95f6dd3bc9efb4292a4e3f264492f05" id="r_ac95f6dd3bc9efb4292a4e3f264492f05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ac95f6dd3bc9efb4292a4e3f264492f05">val_gpu</a> [<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a>]</td></tr>
<tr class="memdesc:ac95f6dd3bc9efb4292a4e3f264492f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead, but don't care enough right now...  <br /></td></tr>
<tr class="separator:ac95f6dd3bc9efb4292a4e3f264492f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99f54969e418c0517309fae3f648588" id="r_ab99f54969e418c0517309fae3f648588"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ab99f54969e418c0517309fae3f648588">segment_gpu</a> [<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a>]</td></tr>
<tr class="separator:ab99f54969e418c0517309fae3f648588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374cb9eb9a8a9a79fa09a0b916acf166" id="r_a374cb9eb9a8a9a79fa09a0b916acf166"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">static</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a> = -1</td></tr>
<tr class="memdesc:a374cb9eb9a8a9a79fa09a0b916acf166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of params living on CPU.  <br /></td></tr>
<tr class="separator:a374cb9eb9a8a9a79fa09a0b916acf166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc47d2cce54457c72a996222ec0a9ce4" id="r_abc47d2cce54457c72a996222ec0a9ce4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">static</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> = -1</td></tr>
<tr class="memdesc:abc47d2cce54457c72a996222ec0a9ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of events living on CPU.  <br /></td></tr>
<tr class="separator:abc47d2cce54457c72a996222ec0a9ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b9e0707c409d990103a531cee49ce0" id="r_a20b9e0707c409d990103a531cee49ce0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a> = 0</td></tr>
<tr class="memdesc:a20b9e0707c409d990103a531cee49ce0"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for variables you often access but rarely overwrite. There are limits on texture memory so don't use huge arrays.  <br /></td></tr>
<tr class="separator:a20b9e0707c409d990103a531cee49ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7cc79856fc0663cb8fd2a9480cccfad" id="r_af7cc79856fc0663cb8fd2a9480cccfad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a> = 0</td></tr>
<tr class="memdesc:af7cc79856fc0663cb8fd2a9480cccfad"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}.  <br /></td></tr>
<tr class="separator:af7cc79856fc0663cb8fd2a9480cccfad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add80696941a37cc8d98c9ef825a0b8db" id="r_add80696941a37cc8d98c9ef825a0b8db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a> = 0</td></tr>
<tr class="memdesc:add80696941a37cc8d98c9ef825a0b8db"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of TF1 per event, index where TF1 start for a given event}.  <br /></td></tr>
<tr class="separator:add80696941a37cc8d98c9ef825a0b8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a466f32a4912da866d5014fd8cdbd06a4" name="a466f32a4912da866d5014fd8cdbd06a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466f32a4912da866d5014fd8cdbd06a4">&#9670;&#160;</a></span>_N_SPLINES_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">define</a> _N_SPLINES_&#160;&#160;&#160;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Hard code the number of splines Not entirely necessary: only used for val_gpu and segment_gpu being device constants. Could move them to not being device constants </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00006">6</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae17e68e55fea24bcac1dde0ef11fe299" name="ae17e68e55fea24bcac1dde0ef11fe299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17e68e55fea24bcac1dde0ef11fe299">&#9670;&#160;</a></span>CleanupGPU_Segments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CleanupGPU_Segments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up pinned variables at CPU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segment</td><td>Found spline segment for each parameter </td></tr>
    <tr><td class="paramname">vals</td><td>Value to which we want reweight for each parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00650">650</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  650</span>                                                                   {</div>
<div class="line"><span class="lineno">  651</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  652</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>);</div>
<div class="line"><span class="lineno">  653</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(vals);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  656</span>  vals = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  659</span>}</div>
<div class="ttc" id="aYamlHelper_8h_html_a1a6adcb8b24bfbdcb936ced6812e1b0c"><div class="ttname"><a href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00021">YamlHelper.h:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ac0e4ea2af61db5278d4a8f8cd6bd5d" name="a1ac0e4ea2af61db5278d4a8f8cd6bd5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac0e4ea2af61db5278d4a8f8cd6bd5d">&#9670;&#160;</a></span>CleanupGPU_SplineMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CleanupGPU_SplineMonolith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_TF1_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights_tf1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the {x},{ybcd} arrays. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_x_array</td><td>Small array with X coefficients at GPU </td></tr>
    <tr><td class="paramname">gpu_many_array</td><td>has length = nKnots * 4, stores all coefficients for all splines and knots </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00602">602</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  618</span>                            {</div>
<div class="line"><span class="lineno">  619</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno">  620</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_paramNo_arr);</div>
<div class="line"><span class="lineno">  621</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_nKnots_arr);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  <span class="comment">// free the coefficient arrays</span></div>
<div class="line"><span class="lineno">  624</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDestroyTextureObject</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>);</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>);</div>
<div class="line"><span class="lineno">  627</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>);</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>);</div>
<div class="line"><span class="lineno">  630</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_TF1</a>);</div>
<div class="line"><span class="lineno">  631</span>  <span class="comment">// free weights on the gpu</span></div>
<div class="line"><span class="lineno">  632</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_weights);</div>
<div class="line"><span class="lineno">  633</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_weights_tf1);</div>
<div class="line"><span class="lineno">  634</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  635</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_total_weights);</div>
<div class="line"><span class="lineno">  636</span>  <span class="comment">//KS: Before removing variable let&#39;s destroy texture</span></div>
<div class="line"><span class="lineno">  637</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDestroyTextureObject</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>);</div>
<div class="line"><span class="lineno">  638</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDestroyTextureObject</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a>);</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_nParamPerEvent);</div>
<div class="line"><span class="lineno">  641</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_nParamPerEvent_TF1</a>);</div>
<div class="line"><span class="lineno">  642</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(cpu_total_weights);</div>
<div class="line"><span class="lineno">  643</span>  cpu_total_weights = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  644</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  646</span>}</div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a20b9e0707c409d990103a531cee49ce0"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a></div><div class="ttdeci">cudaTextureObject_t text_coeff_x</div><div class="ttdoc">KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for vari...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00082">gpuSplineUtils.cu:82</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_add80696941a37cc8d98c9ef825a0b8db"><div class="ttname"><a href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a></div><div class="ttdeci">cudaTextureObject_t text_nParamPerEvent_TF1</div><div class="ttdoc">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of ...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00087">gpuSplineUtils.cu:87</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_af7cc79856fc0663cb8fd2a9480cccfad"><div class="ttname"><a href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a></div><div class="ttdeci">cudaTextureObject_t text_nParamPerEvent</div><div class="ttdoc">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of ...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00085">gpuSplineUtils.cu:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace26806c324dbdc431f36f7b938a9b07" name="ace26806c324dbdc431f36f7b938a9b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace26806c324dbdc431f36f7b938a9b07">&#9670;&#160;</a></span>CopyToGPU_SplineMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CopyToGPU_SplineMonolith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_TF1_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_many_array_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_paramNo_arr_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_nParamPerEvent_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent_TF1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>spline_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>total_nknots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_tf1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy to GPU for x array and separate ybcd array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_x_array</td><td>Small array with X coefficients at GPU </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00203">203</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                                {</div>
<div class="line"><span class="lineno">  233</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a> != <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>) {</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Number of splines not equal to %i, GPU code for event-by-event splines will fail\n&quot;</span>, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>);</div>
<div class="line"><span class="lineno">  235</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;n_params = %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>);</div>
<div class="line"><span class="lineno">  236</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;%s : %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a>);</div>
<div class="line"><span class="lineno">  237</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">exit</a>(-1);</div>
<div class="line"><span class="lineno">  238</span>  }</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  <span class="comment">// Write to the global statics (h_* denotes host stored variable)</span></div>
<div class="line"><span class="lineno">  241</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>;</div>
<div class="line"><span class="lineno">  242</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  243</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>    = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>;</div>
<div class="line"><span class="lineno">  244</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  245</span>  <span class="comment">// Copy the constants</span></div>
<div class="line"><span class="lineno">  246</span>  <span class="comment">// Total number of valid splines for all loaded events</span></div>
<div class="line"><span class="lineno">  247</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>));</div>
<div class="line"><span class="lineno">  248</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  <span class="comment">// Total number of valid TF1 for all loaded events</span></div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a70d02be4848ebb3c6778c1c1250a5288">d_n_TF1</a>,   &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>));</div>
<div class="line"><span class="lineno">  252</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  <span class="comment">// Total spline size per spline; i.e. just the number of points or knots in the spline</span></div>
<div class="line"><span class="lineno">  255</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>));</div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  257</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  258</span>  <span class="comment">// Number of events</span></div>
<div class="line"><span class="lineno">  259</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a>, &amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>));</div>
<div class="line"><span class="lineno">  260</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  261</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  262</span>  <span class="comment">// Copy the coefficient arrays to the GPU; this only happens once per entire Markov Chain so is OK to do multiple extensive memory copies</span></div>
<div class="line"><span class="lineno">  263</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array</a>.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  264</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_x_array</a>.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  267</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  270</span>  <span class="comment">//KS: Tried also moving gpu_many_array to texture memory it only worked with restricted number of MC runs, most likely hit texture memory limit :(</span></div>
<div class="line"><span class="lineno">  271</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>;</div>
<div class="line"><span class="lineno">  272</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>));</div>
<div class="line"><span class="lineno">  273</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  274</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.devPtr = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>;</div>
<div class="line"><span class="lineno">  275</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;float&gt;</a>();</div>
<div class="line"><span class="lineno">  276</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.sizeInBytes = <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>;</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  279</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>;</div>
<div class="line"><span class="lineno">  280</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>));</div>
<div class="line"><span class="lineno">  281</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">// Create texture object</span></div>
<div class="line"><span class="lineno">  284</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  285</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  <span class="comment">// Also copy the parameter number for each spline onto the GPU; i.e. what spline parameter are we calculating right now</span></div>
<div class="line"><span class="lineno">  288</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_paramNo_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  289</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// Also copy the knot map for each spline onto the GPU;</span></div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nKnots_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_nKnots_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  <span class="comment">//Now TF1</span></div>
<div class="line"><span class="lineno">  296</span>  <span class="comment">// Copy the coefficient arrays to the GPU; this only happens once per entire Markov Chain so is OK to do multiple extensive memory copies</span></div>
<div class="line"><span class="lineno">  297</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array_TF1</a>.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>*<a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  298</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  <span class="comment">// Also copy the parameter number for each TF1 onto the GPU; i.e. what TF1 parameter are we calculating right now</span></div>
<div class="line"><span class="lineno">  301</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_TF1</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_paramNo_arr_TF1</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  302</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  305</span>  <span class="comment">//KS: Keep track how much splines each event has</span></div>
<div class="line"><span class="lineno">  306</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nParamPerEvent, cpu_nParamPerEvent.data(), 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  307</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">// create a resource descriptor based on device pointers</span></div>
<div class="line"><span class="lineno">  311</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  312</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  314</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.devPtr = gpu_nParamPerEvent;</div>
<div class="line"><span class="lineno">  315</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;unsigned int&gt;</a>();</div>
<div class="line"><span class="lineno">  316</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.sizeInBytes = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>);</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  319</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  320</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  321</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  <span class="comment">//Finally create texture object</span></div>
<div class="line"><span class="lineno">  324</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="comment">// Now TF1</span></div>
<div class="line"><span class="lineno">  328</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_nParamPerEvent_TF1</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_nParamPerEvent_TF1</a>.data(), 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  329</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  332</span>  <span class="comment">// create a resource descriptor based on device pointers</span></div>
<div class="line"><span class="lineno">  333</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>;</div>
<div class="line"><span class="lineno">  334</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>));</div>
<div class="line"><span class="lineno">  335</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  336</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>.res.linear.devPtr = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_nParamPerEvent_TF1</a>;</div>
<div class="line"><span class="lineno">  337</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;unsigned int&gt;</a>();</div>
<div class="line"><span class="lineno">  338</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>.res.linear.sizeInBytes = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>);</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  341</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent_tf1</a>;</div>
<div class="line"><span class="lineno">  342</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent_tf1</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent_tf1</a>));</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent_tf1</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>  <span class="comment">//Finally create texture object</span></div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent_tf1</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent_tf1</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  350</span>}</div>
<div class="ttc" id="aSplineCommon_8h_html_a283177311bade7400c6088e8fad71a1f"><div class="ttname"><a href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a></div><div class="ttdeci">#define _nCoeff_</div><div class="ttdoc">KS: We store coefficients {y,b,c,d} in one array one by one, this is only to define it once rather th...</div><div class="ttdef"><b>Definition</b> <a href="SplineCommon_8h_source.html#l00008">SplineCommon.h:8</a></div></div>
<div class="ttc" id="aSplineCommon_8h_html_a911160077ffa38727e0494f178ce380a"><div class="ttname"><a href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a></div><div class="ttdeci">#define _nTF1Coeff_</div><div class="ttdoc">KS: For TF1 we store at most 5 coefficients, we could make it more flexible but for now define it her...</div><div class="ttdef"><b>Definition</b> <a href="SplineCommon_8h_source.html#l00010">SplineCommon.h:10</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a374cb9eb9a8a9a79fa09a0b916acf166"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a></div><div class="ttdeci">static int h_n_params</div><div class="ttdoc">Number of params living on CPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00072">gpuSplineUtils.cu:72</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a466f32a4912da866d5014fd8cdbd06a4"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a></div><div class="ttdeci">#define _N_SPLINES_</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00006">gpuSplineUtils.cu:6</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a70d02be4848ebb3c6778c1c1250a5288"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a70d02be4848ebb3c6778c1c1250a5288">d_n_TF1</a></div><div class="ttdeci">__device__ __constant__ unsigned int d_n_TF1</div><div class="ttdoc">Number of tf1 living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00059">gpuSplineUtils.cu:59</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a8df652f27dcffc6b349298601ed790ea"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a></div><div class="ttdeci">__device__ __constant__ unsigned int d_n_splines</div><div class="ttdoc">Number of splines living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00057">gpuSplineUtils.cu:57</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_abc47d2cce54457c72a996222ec0a9ce4"><div class="ttname"><a href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a></div><div class="ttdeci">static int h_n_events</div><div class="ttdoc">Number of events living on CPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00075">gpuSplineUtils.cu:75</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ad333bfa4035ada9207fc1df19272c4e2"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a></div><div class="ttdeci">__device__ __constant__ int d_n_events</div><div class="ttdoc">Number of events living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00064">gpuSplineUtils.cu:64</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ae11082fcc44d3cf2e38cb74043fd7835"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a></div><div class="ttdeci">__device__ __constant__ short int d_spline_size</div><div class="ttdoc">Size of splines living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00061">gpuSplineUtils.cu:61</a></div></div>
<div class="ttc" id="agpuUtils_8cuh_html_a0345e89c96b417069f1e64674cc77318"><div class="ttname"><a href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a></div><div class="ttdeci">#define CudaCheckError()</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cuh_source.html#l00018">gpuUtils.cuh:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a2f7c752f784e5e0dfc4b06c25608f9" name="a6a2f7c752f784e5e0dfc4b06c25608f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2f7c752f784e5e0dfc4b06c25608f9">&#9670;&#160;</a></span>EvalOnGPU_Splines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_Splines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_coeff_many</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>text_coeff_x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the spline on the GPU Using one {y,b,c,d} array and one {x} array Should be most efficient at cache hitting and memory coalescence But using spline segments rather than the parameter value: avoids doing binary search on GPU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_paramNo_arr</td><td>has length = spln_counter (keeps track of which parameter we're using on this thread) </td></tr>
    <tr><td class="paramname">gpu_nKnots_arr</td><td>has length = spln_counter (keeps track where current spline starts) </td></tr>
    <tr><td class="paramname">gpu_coeff_many</td><td>has length = nKnots * 4, stores all coefficients for all splines and knots </td></tr>
    <tr><td class="paramname">gpu_weights</td><td>has length = spln_counter * spline_size </td></tr>
    <tr><td class="paramname">text_coeff_x</td><td>array storing info about X coeff, uses texture memory. Has length = n_params * spline_size, </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00363">363</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  368</span>                                                         {</div>
<div class="line"><span class="lineno">  369</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  <span class="comment">// points per spline is the offset to skip in the index to move between splines</span></div>
<div class="line"><span class="lineno">  372</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>  <span class="comment">// this is the stopping condition!</span></div>
<div class="line"><span class="lineno">  375</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>) {</div>
<div class="line"><span class="lineno">  376</span>    <span class="comment">// This is the segment we want for this parameter variation</span></div>
<div class="line"><span class="lineno">  377</span>    <span class="comment">// for this particular splineNum; 0 = MACCQE, 1 = pFC, 2 = EBC, etc</span></div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment">//CW: Which Parameter we are accesing</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a> = gpu_paramNo_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>];</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="comment">//CW: Avoids doing costly binary search on GPU</span></div>
<div class="line"><span class="lineno">  383</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ab99f54969e418c0517309fae3f648588">segment_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>];</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="comment">//KS: Segment for coeff_x is simply parameter*max knots + segment as each parmeters has the same spacing</span></div>
<div class="line"><span class="lineno">  386</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="comment">//KS: Find knot position in out monolitical structure</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a> = gpu_nKnots_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>;</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">// We&#39;ve read the segment straight from CPU and is saved in segment_gpu</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">// polynomial parameters from the monolithic splineMonolith</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fY</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>];</div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fB</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+1];</div>
<div class="line"><span class="lineno">  395</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fC</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+2];</div>
<div class="line"><span class="lineno">  396</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fD</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+3];</div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a> = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ac95f6dd3bc9efb4292a4e3f264492f05">val_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>] - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;float&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a>);</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <span class="comment">//CW: Wooow, let&#39;s use some fancy intrinsics and pull down the processing time by &lt;1% from normal multiplication! HURRAY</span></div>
<div class="line"><span class="lineno">  401</span>    gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fD</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fC</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fB</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fY</a>);</div>
<div class="line"><span class="lineno">  402</span>    <span class="comment">// Or for the more &quot;easy to read&quot; version:</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="comment">//gpu_weights[splineNum] = (fY+dx*(fB+dx*(fC+dx*fD)));</span></div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span><span class="comment">//#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  406</span>  <span class="comment">//printf(&quot;splineNum = %i/%i, paramNo = %i, variation = %f, segment = %i, fX = %f, fX+1 = %f, dx = %f, d_n_splines = %i, d_spline_size = %i, weight = %f \n&quot;, splineNum, d_n_splines, gpu_paramNo_arr[splineNum], val_gpu[Param], segment, tex1Dfetch&lt;float&gt;(text_coeff_x, segment_X), tex1Dfetch&lt;float&gt;(text_coeff_x, segment_X+1), dx, d_n_splines, d_spline_size, gpu_weights[splineNum]);</span></div>
<div class="line"><span class="lineno">  407</span><span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  408</span>  }</div>
<div class="line"><span class="lineno">  409</span>}</div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ab99f54969e418c0517309fae3f648588"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ab99f54969e418c0517309fae3f648588">segment_gpu</a></div><div class="ttdeci">__device__ __constant__ short int segment_gpu[NSplines_GPU]</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00068">gpuSplineUtils.cu:68</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ac95f6dd3bc9efb4292a4e3f264492f05"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ac95f6dd3bc9efb4292a4e3f264492f05">val_gpu</a></div><div class="ttdeci">__device__ __constant__ float val_gpu[NSplines_GPU]</div><div class="ttdoc">CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead,...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00067">gpuSplineUtils.cu:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae90fdf441edbf7a4d3520c3121f6e7a9" name="ae90fdf441edbf7a4d3520c3121f6e7a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae90fdf441edbf7a4d3520c3121f6e7a9">&#9670;&#160;</a></span>EvalOnGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_coeffs_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights_tf1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the TF1 on the GPU Using 5th order polynomial. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_coeffs_tf1</td><td>coefficients of TF1, has length = tf1 coeef counter </td></tr>
    <tr><td class="paramname">gpu_paramNo_arr_tf1</td><td>has length = spln_counter (keeps track of which parameter we're using on this thread) </td></tr>
    <tr><td class="paramname">gpu_weights_tf1</td><td>has length = spln_counter * spline_size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00413">413</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>                            {</div>
<div class="line"><span class="lineno">  417</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>  <span class="comment">// points per spline is the offset to skip in the index to move between splines</span></div>
<div class="line"><span class="lineno">  420</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a70d02be4848ebb3c6778c1c1250a5288">d_n_TF1</a>) {</div>
<div class="line"><span class="lineno">  423</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno">  424</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> x = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ac95f6dd3bc9efb4292a4e3f264492f05">val_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_arr_tf1</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a>]];</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">// Read the coefficients</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs_tf1</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a>*<a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>];</div>
<div class="line"><span class="lineno">  428</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs_tf1</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a>*<a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+1];</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    gpu_weights_tf1[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tf1Num</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a>, x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">// gpu_weights_tf1[tf1Num] = a*x + b;</span></div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">//gpu_weights_tf1[tf1Num] = 1 + a*x + b*x*x + c*x*x*x + d*x*x*x*x + e*x*x*x*x*x;</span></div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="comment">//#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  437</span>    <span class="comment">//printf(&quot;TF1 = %i/%i, weight = %f \n&quot;, tf1Num, d_n_TF1, gpu_weights_tf1[tf1Num]);</span></div>
<div class="line"><span class="lineno">  438</span>    <span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  439</span>  }</div>
<div class="line"><span class="lineno">  440</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1af53253fb379e8c3eaba886add0ba04" name="a1af53253fb379e8c3eaba886add0ba04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af53253fb379e8c3eaba886add0ba04">&#9670;&#160;</a></span>EvalOnGPU_TotWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_TotWeight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_weights_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>text_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>text_nParamPerEvent_TF1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Evaluate the total spline event weight on the GPU, as in most cases GPU is faster, even more this significant reduce memory transfer from GPU to CPU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_weights</td><td>Weight for each spline object </td></tr>
    <tr><td class="paramname">gpu_weights_tf1</td><td>Weight for each TF1 object </td></tr>
    <tr><td class="paramname">gpu_total_weights</td><td>Total weight for each event </td></tr>
    <tr><td class="paramname">text_nParamPerEvent</td><td>map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event} </td></tr>
    <tr><td class="paramname">text_nParamPerEvent_TF1</td><td>map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event} </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00445">445</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  452</span>                                                                  {</div>
<div class="line"><span class="lineno">  453</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  454</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>  <span class="comment">//KS: Accessing shared memory is much much faster than global memory hence we use shared memory for calculation and then write to global memory</span></div>
<div class="line"><span class="lineno">  457</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__shared__</a> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_define" href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a>];</div>
<div class="line"><span class="lineno">  458</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a>) <span class="comment">//stopping condition</span></div>
<div class="line"><span class="lineno">  459</span>  {</div>
<div class="line"><span class="lineno">  460</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x] = 1.f;</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a> = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>;</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id &lt; tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>)</div>
<div class="line"><span class="lineno">  465</span>    {</div>
<div class="line"><span class="lineno">  466</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x] *= gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>+1) + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>];</div>
<div class="line"><span class="lineno">  467</span>      <span class="comment">//#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  468</span>      <span class="comment">//printf(&quot;Event = %i, Spline_Num = %i, gpu_weights = %f \n&quot;,</span></div>
<div class="line"><span class="lineno">  469</span>      <span class="comment">//        EventNum, tex1Dfetch&lt;unsigned int&gt;(text_nParamPerEvent, 2*EventNum+1) + id, gpu_weights[tex1Dfetch&lt;unsigned int&gt;(text_nParamPerEvent, 2*EventNum+1) + id]);</span></div>
<div class="line"><span class="lineno">  470</span>      <span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  471</span>    }</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id &lt; tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>)</div>
<div class="line"><span class="lineno">  474</span>    {</div>
<div class="line"><span class="lineno">  475</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x] *= gpu_weights_tf1[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>+1) + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>];</div>
<div class="line"><span class="lineno">  476</span>      <span class="comment">//#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  477</span>      <span class="comment">//printf(&quot;Event = %i, Spline_Num = %i, gpu_weights_tf1 = %f \n&quot;,</span></div>
<div class="line"><span class="lineno">  478</span>      <span class="comment">//       EventNum, tex1Dfetch&lt;unsigned int&gt;(text_nParamPerEvent_TF1, 2*EventNum+1) + id, gpu_weights_tf1[tex1Dfetch&lt;unsigned int&gt;(text_nParamPerEvent_TF1, 2*EventNum+1) + id]);</span></div>
<div class="line"><span class="lineno">  479</span>      <span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  480</span>    }</div>
<div class="line"><span class="lineno">  481</span>    gpu_total_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x];</div>
<div class="line"><span class="lineno">  482</span>  }</div>
<div class="line"><span class="lineno">  483</span>}</div>
<div class="ttc" id="agpuUtils_8cuh_html_a393d21a8f493c2561a0ae703973dccc2"><div class="ttname"><a href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a></div><div class="ttdeci">#define _BlockSize_</div><div class="ttdoc">KS: Need it for shared memory, there is way to use dynamic shared memory but I am lazy right now.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cuh_source.html#l00021">gpuUtils.cuh:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a619be845847738447535c5628ff72c4c" name="a619be845847738447535c5628ff72c4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a619be845847738447535c5628ff72c4c">&#9670;&#160;</a></span>InitGPU_Segments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_Segments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>segment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for spline segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segment</td><td>Found spline segment for each parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00179">179</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                                    {</div>
<div class="line"><span class="lineno">  180</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  181</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  182</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  183</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  184</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a114ab798373602259d32aaabd590646a" name="a114ab798373602259d32aaabd590646a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114ab798373602259d32aaabd590646a">&#9670;&#160;</a></span>InitGPU_SplineMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_SplineMonolith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_many_TF1_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_weights_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_paramNo_TF1_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>total_nknots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>Eve_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory on gpu for spline monolith. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_x_array</td><td>Small array with X coefficients at GPU </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00097">97</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  119</span>                                        {</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="comment">// Allocate chunks of memory to GPU</span></div>
<div class="line"><span class="lineno">  122</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nKnots_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  132</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <span class="comment">// Allocate memory for the array of weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  136</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <span class="comment">// Now TF1 specific</span></div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_TF1_array</a>, <a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_weights_tf1, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_paramNo_TF1_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  149</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) cpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">//KS: Allocate memory for the array of total weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  155</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  156</span>  </div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">//KS: Allocate memory for the map keeping track how many splines each parameter has</span></div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nParamPerEvent, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  160</span>  </div>
<div class="line"><span class="lineno">  161</span>  <span class="comment">//KS: Allocate memory for the map keeping track how many TF1 each parameter has</span></div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nParamPerEvent_tf1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  163</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  164</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  165</span>  </div>
<div class="line"><span class="lineno">  166</span>  <span class="comment">// Print allocation info to user</span></div>
<div class="line"><span class="lineno">  167</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Allocated %i entries for paramNo and nKnots arrays, size = %f MB\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>+<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>)/1.E6);</div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Allocated %i entries for x coeff arrays, size = %f MB\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>)/1.E6);</div>
<div class="line"><span class="lineno">  169</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Allocated %i entries for {ybcd} coeff arrays, size = %f MB\n&quot;</span>, <a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">total_nknots</a>)/1.E6);</div>
<div class="line"><span class="lineno">  170</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Allocated %i entries for TF1 coefficient arrays, size = %f MB\n&quot;</span>, <a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_define" href="SplineCommon_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_tf1</a>)/1.E6);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <span class="comment">//KS: Ask CUDA about memory usage</span></div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_function" href="gpuUtils_8cu.html#a5cfcf006bd817b3cff5da08c7f0ecb5e">checkGpuMem</a>();</div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_function" href="gpuUtils_8cu.html#acbef44018c81d3830eb03d342bd55dd0">PrintNdevices</a>();</div>
<div class="line"><span class="lineno">  175</span>}</div>
<div class="ttc" id="agpuUtils_8cu_html_a5cfcf006bd817b3cff5da08c7f0ecb5e"><div class="ttname"><a href="gpuUtils_8cu.html#a5cfcf006bd817b3cff5da08c7f0ecb5e">checkGpuMem</a></div><div class="ttdeci">void checkGpuMem()</div><div class="ttdoc">KS: Get some fancy info about VRAM usage.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cu_source.html#l00045">gpuUtils.cu:45</a></div></div>
<div class="ttc" id="agpuUtils_8cu_html_acbef44018c81d3830eb03d342bd55dd0"><div class="ttname"><a href="gpuUtils_8cu.html#acbef44018c81d3830eb03d342bd55dd0">PrintNdevices</a></div><div class="ttdeci">void PrintNdevices()</div><div class="ttdoc">KS: Get some fancy info about GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cu_source.html#l00063">gpuUtils.cu:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc3b24da038d746b5ccfcee61ba26b90" name="acc3b24da038d746b5ccfcee61ba26b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc3b24da038d746b5ccfcee61ba26b90">&#9670;&#160;</a></span>InitGPU_Vals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_Vals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>vals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for spline segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vals</td><td>Value to which we want reweight for each parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00188">188</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>                                         {</div>
<div class="line"><span class="lineno">  189</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) vals, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  193</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  194</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4df46d32133c7ac37dbe2f2dae8b91b5" name="a4df46d32133c7ac37dbe2f2dae8b91b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df46d32133c7ac37dbe2f2dae8b91b5">&#9670;&#160;</a></span>RunGPU_SplineMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> RunGPU_SplineMonolith </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeff_many</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_tf1_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeff_many_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights_tf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>h_n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>h_n_tf1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the GPU code for the separate many arrays. As in separate {x}, {y,b,c,d} arrays Pass the segment and the parameter values (binary search already performed in SplineMonolith::FindSplineSegment() </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpu_coeff_many</td><td>has length = nKnots * 4, stores all coefficients for all splines and knots </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00490">490</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  513</span>                                {</div>
<div class="line"><span class="lineno">  514</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>;</div>
<div class="line"><span class="lineno">  517</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x = <a class="code hl_define" href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a>;</div>
<div class="line"><span class="lineno">  520</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// Copy the segment values to the GPU (segment_gpu), which is h_n_params long</span></div>
<div class="line"><span class="lineno">  523</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ab99f54969e418c0517309fae3f648588">segment_gpu</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  524</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>  <span class="comment">// Copy the parameter values values to the GPU (vals_gpu), which is h_n_params long</span></div>
<div class="line"><span class="lineno">  527</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ac95f6dd3bc9efb4292a4e3f264492f05">val_gpu</a>, vals, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  528</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>  <span class="comment">// KS: Consider asynchronous kernel call, this might help EvalOnGPU_Splines and EvalOnGPU_TF1 are independent</span></div>
<div class="line"><span class="lineno">  531</span>  <span class="comment">// Set the cache config to prefer L1 for the kernel</span></div>
<div class="line"><span class="lineno">  532</span>  <span class="comment">//cudaFuncSetCacheConfig(EvalOnGPU_Splines, cudaFuncCachePreferL1);</span></div>
<div class="line"><span class="lineno">  533</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_Splines&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  534</span>      gpu_paramNo_arr,</div>
<div class="line"><span class="lineno">  535</span>      gpu_nKnots_arr,</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>      gpu_coeff_many,</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>      gpu_weights,</div>
<div class="line"><span class="lineno">  540</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a></div>
<div class="line"><span class="lineno">  541</span>      );</div>
<div class="line"><span class="lineno">  542</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_tf1</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  545</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_TF1&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  546</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeff_many_tf1</a>,</div>
<div class="line"><span class="lineno">  547</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_paramNo_tf1_arr</a>,</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    gpu_weights_tf1</div>
<div class="line"><span class="lineno">  550</span>  );</div>
<div class="line"><span class="lineno">  551</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span><span class="comment">//KS: We can either copy gpu_weight and calculate total weight in reweighting loop, or not copy and calculate total weight stall at GPU, which means less memory transfer</span></div>
<div class="line"><span class="lineno">  554</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  555</span>  <span class="comment">// Here we have to make a somewhat large GPU-&gt;CPU transfer because it&#39;s all the splines&#39; response</span></div>
<div class="line"><span class="lineno">  556</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(cpu_weights, gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>);</div>
<div class="line"><span class="lineno">  557</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_weights_tf1</a>, gpu_weights_tf1, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_tf1</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>);</div>
<div class="line"><span class="lineno">  560</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span><span class="comment">//KS: Else calculate Total Weight</span></div>
<div class="line"><span class="lineno">  563</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  564</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_TotWeight&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  567</span>      gpu_weights,</div>
<div class="line"><span class="lineno">  568</span>      gpu_weights_tf1,</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>      gpu_total_weights,</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno">  573</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#add80696941a37cc8d98c9ef825a0b8db">text_nParamPerEvent_TF1</a></div>
<div class="line"><span class="lineno">  574</span>      );</div>
<div class="line"><span class="lineno">  575</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>  <span class="comment">//KS: Here we have to make a somewhat large GPU-&gt;CPU transfer because it is proportional to number of events</span></div>
<div class="line"><span class="lineno">  578</span>  <span class="comment">//KS: Normally code wait for memory transfer to finish before moving further cudaMemcpyAsync means we will continue to execute code and in a meantime keep copying stuff.</span></div>
<div class="line"><span class="lineno">  579</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyAsync</a>(cpu_total_weights, gpu_total_weights, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>, 0);</div>
<div class="line"><span class="lineno">  580</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  581</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span><span class="comment">//#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  584</span><span class="comment">//printf(&quot;Copied GPU total weights to CPU with SUCCESS (drink more tea)\n&quot;);</span></div>
<div class="line"><span class="lineno">  585</span><span class="comment">//printf(&quot;Released calculated response from GPU with SUCCESS (drink most tea)\n&quot;);</span></div>
<div class="line"><span class="lineno">  586</span><span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  587</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a953e5c5aecebd908f5d8c6ad64de482c" name="a953e5c5aecebd908f5d8c6ad64de482c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a953e5c5aecebd908f5d8c6ad64de482c">&#9670;&#160;</a></span>SynchroniseSplines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SynchroniseSplines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure all Cuda threads finished execution. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00591">591</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  591</span>                                   {</div>
<div class="line"><span class="lineno">  592</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDeviceSynchronize</a>();</div>
<div class="line"><span class="lineno">  593</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad333bfa4035ada9207fc1df19272c4e2" name="ad333bfa4035ada9207fc1df19272c4e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad333bfa4035ada9207fc1df19272c4e2">&#9670;&#160;</a></span>d_n_events</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_n_events</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of events living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00064">64</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a8df652f27dcffc6b349298601ed790ea" name="a8df652f27dcffc6b349298601ed790ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df652f27dcffc6b349298601ed790ea">&#9670;&#160;</a></span>d_n_splines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_n_splines</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of splines living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00057">57</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a70d02be4848ebb3c6778c1c1250a5288" name="a70d02be4848ebb3c6778c1c1250a5288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d02be4848ebb3c6778c1c1250a5288">&#9670;&#160;</a></span>d_n_TF1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_n_TF1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of tf1 living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00059">59</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="ae11082fcc44d3cf2e38cb74043fd7835" name="ae11082fcc44d3cf2e38cb74043fd7835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae11082fcc44d3cf2e38cb74043fd7835">&#9670;&#160;</a></span>d_spline_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_spline_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of splines living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00061">61</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="abc47d2cce54457c72a996222ec0a9ce4" name="abc47d2cce54457c72a996222ec0a9ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc47d2cce54457c72a996222ec0a9ce4">&#9670;&#160;</a></span>h_n_events</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> h_n_events = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of events living on CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00075">75</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a374cb9eb9a8a9a79fa09a0b916acf166" name="a374cb9eb9a8a9a79fa09a0b916acf166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374cb9eb9a8a9a79fa09a0b916acf166">&#9670;&#160;</a></span>h_n_params</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> h_n_params = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of params living on CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00072">72</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="ab99f54969e418c0517309fae3f648588" name="ab99f54969e418c0517309fae3f648588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99f54969e418c0517309fae3f648588">&#9670;&#160;</a></span>segment_gpu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> segment_gpu[<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00068">68</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a20b9e0707c409d990103a531cee49ce0" name="a20b9e0707c409d990103a531cee49ce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b9e0707c409d990103a531cee49ce0">&#9670;&#160;</a></span>text_coeff_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> text_coeff_x = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for variables you often access but rarely overwrite. There are limits on texture memory so don't use huge arrays. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00082">82</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="af7cc79856fc0663cb8fd2a9480cccfad" name="af7cc79856fc0663cb8fd2a9480cccfad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7cc79856fc0663cb8fd2a9480cccfad">&#9670;&#160;</a></span>text_nParamPerEvent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> text_nParamPerEvent = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00085">85</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="add80696941a37cc8d98c9ef825a0b8db" name="add80696941a37cc8d98c9ef825a0b8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add80696941a37cc8d98c9ef825a0b8db">&#9670;&#160;</a></span>text_nParamPerEvent_TF1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> text_nParamPerEvent_TF1 = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of TF1 per event, index where TF1 start for a given event}. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00087">87</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="ac95f6dd3bc9efb4292a4e3f264492f05" name="ac95f6dd3bc9efb4292a4e3f264492f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac95f6dd3bc9efb4292a4e3f264492f05">&#9670;&#160;</a></span>val_gpu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> val_gpu[<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_GPU</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead, but don't care enough right now... </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00067">67</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
